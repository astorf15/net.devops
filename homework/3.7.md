#### Домашнее задание к занятию "3.7. Компьютерные сети, лекция 2"
#
1. Просмотр списка сетевых интерфейсов в `Linux` осуществляется с помощью клманды: 
    
    ```bash
    ip l - краткий вывод 

    ip a - подробный вывод

    ip -c -br l - краткий вывод состояния интерфейсов
    ```
    Для `Windows` используется команда `ipconfig /all`
2. Для обнаружения соседних устройств в сети используется протокол канального уровня `LLDP` (Link Layer Discovery Protocol). В `Linux` используется пакет `LLDPD`, посмотреть вывод информации можно с помощью комнды `lldpctl`   
3. Технология разделения сети на несколько виртуальных сетей называется Vlan и имеет то же название пакета в ОС `Linux` (vlan)
    * настроим vlan с помощью netplan, отредактируем файл `etc/netplan/01-netcfg.yaml`
    ##### vlan config
    ```bash
    network:
        version: 2
        renderer: networkd
        ethernets:
            eth0:
            dhcp4: true

            eth1:
            dhcp4: true
    vlans:
        vlan5:
            id: 5
            link: eth1
            dhcp4: no
            addresses: [192.168.1.3/24]
            gateway4: 192.168.1.1
    ```        
    * проверим и применим настройки командами: 
    ```bash
    sudo netplan --debug generate
    sudo netplan apply
    ```
4. Типы агрегации сетевых интерфейсов `(bonding)` и опции блансировки в `Linux`
    * `Mode-0(balance-rr)` – Данный режим используется по умолчанию. Balance-rr обеспечивается балансировку нагрузки и отказоустойчивость. В данном режиме сетевые пакеты отправляются “по кругу”, от первого интерфейса к последнему. Если выходят из строя интерфейсы, пакеты отправляются на остальные оставшиеся. Дополнительной настройки коммутатора не требуется при нахождении портов в одном коммутаторе. При разностных коммутаторах требуется дополнительная настройка.

    * `Mode-1(active-backup)` – Один из интерфейсов работает в активном режиме, остальные в ожидающем. При обнаружении проблемы на активном интерфейсе производится переключение на ожидающий интерфейс. Не требуется поддержки от коммутатора.

    * `Mode-2(balance-xor)` – Передача пакетов распределяется по типу входящего и исходящего трафика по формуле ((MAC src) XOR (MAC dest)) % число интерфейсов. Режим дает балансировку нагрузки и отказоустойчивость. Не требуется дополнительной настройки коммутатора/коммутаторов.

    * `Mode-3(broadcast)` – Происходит передача во все объединенные интерфейсы, тем самым обеспечивая отказоустойчивость. Рекомендуется только для использования MULTICAST трафика.

    * `Mode-4(802.3ad)` – динамическое объединение одинаковых портов. В данном режиме можно значительно увеличить пропускную способность входящего так и исходящего трафика. Для данного режима необходима поддержка и настройка коммутатора/коммутаторов.

    * `Mode-5(balance-tlb)` – Адаптивная балансировки нагрузки трафика. Входящий трафик получается только активным интерфейсом, исходящий распределяется в зависимости от текущей загрузки канала каждого интерфейса. Не требуется специальной поддержки и настройки коммутатора/коммутаторов.

    * `Mode-6(balance-alb)` – Адаптивная балансировка нагрузки. Отличается более совершенным алгоритмом балансировки нагрузки чем Mode-5). Обеспечивается балансировку нагрузки как исходящего так и входящего трафика. Не требуется специальной поддержки и настройки коммутатора/коммутаторов.
    ##### bonding config
    ```bash
    network:
    version: 2
    renderer: networkd
    bonds:
        bond0:
            dhcp4: yes
            interfaces:
                - eth0
                - erh1
            parameters:
                mode: active-backup 
                primary: eth0
    ``` 
5.  
    * Маска `/29` = `6` узловым адресам (хостам)
    * Из сети с маской `/24` можно получить `32` подсети с маской `/29`
    ```bash 
        Маска подсети         |Кол-во подсетей |хостов в подсети|
    1	255.255.255.128 (/25)	    2	            126
    2	255.255.255.192 (/26)	    4	            62
    3	255.255.255.224 (/27)	    8	            30
    4	255.255.255.240 (/28)	    16	            14
    5	255.255.255.248 (/29)	    32	            6
    6	255.255.255.252 (/30)	    64	            2
    7	255.255.255.254 (/31)	    128	            1
    ```
    * С помощью утилиты `ipcalc` разобьем сеть `10.10.10.0/24` на несколько подсетей с маской `/29`
    ```bash
    ipcalc -b --split 6 6 6 10.10.10.0/24

    Network:   10.10.10.0/29
    Network:   10.10.10.8/29
    Network:   10.10.10.16/29
    ```
6. В случае елси все адреса частных сетей заняты можно использовать для решения задачи подсеть `100.64.255.0/26` 

7. Просмотр `arp` таблицы в `Linux` и `Windows` осуществлется с помощью команды `arp -a` 
    ```bash
    sudo arp -d 10.1.1.3 - удалить запись из arp таблици
    sudo ip neigh flush all - очистить кэш записей
    ```
#

#### Вопросы:
1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?

2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?

3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.

4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.

6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.

7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?



 ---
## Задание для самостоятельной отработки (необязательно к выполнению)

 8*. Установите эмулятор EVE-ng.

 Инструкция по установке - https://github.com/svmyasnikov/eve-ng

 Выполните задания на lldp, vlan, bonding в эмуляторе EVE-ng. 